 function clog(){debug.log.apply(debug,arguments);} function cwarn(){debug.warn.apply(debug,arguments);} if(!String.prototype.cap1stChar){String.prototype.cap1stChar=function(){return this.substring(0,1).toUpperCase()+ this.substring(1,this.length);};} if(!String.prototype.unCamelCase){String.prototype.unCamelCase=function(){var out=this.replace(/^[a-z]|[^\s][A-Z]/g,function(str,offset){if(offset==0){return(str.toUpperCase());}else{return(str.substr(0,1)+" "+str.substr(1).toUpperCase());}});return(out);};} if(!String.prototype.startsWith){String.prototype.startsWith=function(searchString,position){position=position||0;return this.substr(position,searchString.length)===searchString;};} if(!String.prototype.endsWith){String.prototype.endsWith=function(searchString,position){var subjectString=this.toString();if(typeof position!=='number'||!isFinite(position)||Math.floor(position)!==position||position>subjectString.length){position=subjectString.length;} position-=searchString.length;var lastIndex=subjectString.lastIndexOf(searchString,position);return lastIndex!==-1&&lastIndex===position;};} if(!String.prototype.format){String.prototype.format=function(){var args=arguments;return this.replace(/{(\d+)}/g,function(match,number){return typeof args[number]!='undefined'?args[number]:match;});};} if(!Date.prototype.getDayName){Date.prototype.getDayName=function(){var days=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];return days[this.getDay()];};} if(!Date.prototype.getISOWeek){Date.prototype.getISOWeek=function(){var janFirst=new Date(this.getFullYear(),0,1);return Math.ceil((((this-janFirst)/86400000)+janFirst.getDay()+1)/7);};} if(!Array.prototype.equals){Array.prototype.equals=function(oa){if(oa&&oa.length===this.length){if(this===oa){return true;} for(var idx=0;idx<this.length;idx++){if(this[idx]!==oa[idx]){return false;}} return true;} return false;};} if(!Array.prototype.contains){Array.prototype.contains=function(element){for(var i=0;i<this.length;i++){if(this[i]===element){return true;}} return false;};} if(!Array.prototype.getRandomItem){Array.prototype.getRandomItem=function(){var idx=Math.floor(Math.random()*this.length);return this[idx];};} if(!Array.prototype.forEach){Array.prototype.forEach=function(fun){var len=this.length>>>0;if(typeof fun!=="function"){throw new TypeError();} var thisp=arguments[1];for(var i=0;i<len;i++){if(i in this){fun.call(thisp,this[i],i,this);}}};} if(!Object.keys){Object.keys=(function(){'use strict';var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!({toString:null}).propertyIsEnumerable('toString'),dontEnums=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'],dontEnumsLength=dontEnums.length;return function(obj){if(typeof obj!=='object'&&(typeof obj!=='function'||obj===null)){throw new TypeError('Object.keys called on non-object');} var result=[],prop,i;for(prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop);}} if(hasDontEnumBug){for(i=0;i<dontEnumsLength;i++){if(hasOwnProperty.call(obj,dontEnums[i])){result.push(dontEnums[i]);}}} return result;};}());} Ext.ns('bats');bats.titleViewMode='<span style="font-size: smaller; font-weight: normal; padding-left: .5em;">(view mode)</span>';bats.getRandomInt=function(min,max){return Math.floor(Math.random()*(max-min+1))+min;};bats.apply=function(o,c,defaults){if(defaults){bats.apply(o,defaults);} if(o&&c&&typeof c==='object'){for(var p in c){o[p]=c[p];}} return o;};bats.applyIf=function(o,c){if(o&&c&&typeof c==='object'){for(var p in c){if(typeof(o[p])==='undefined'){o[p]=c[p];}}} return o;};bats.applyIf(bats,{MT_CSV:'text/csv',MT_HTML:'text/html',MT_JAVASCRIPT:'text/javascript',region:null,envOffset:null,localOffset:new Date().getTimezoneOffset()/60*-1,tzOffset:function(){if(bats.envOffset===null){return 0;} return bats.envOffset-bats.localOffset;},isEmptyObject:function(o){for(var k in o){if(o.hasOwnProperty(k)){return false;}} return true;},isTrue:function(val){if(typeof val==='boolean'){return val;} val=String(val).toLowerCase();return val==='true'||val==='yes'||val==='t'||val==='y'||val==='1'||val==='on';},isEcn:function(){return bats.region==='ecn';},isMtf:function(){return bats.region==='mtf';},isAlpha:function(){return bats.region==='alpha';},isTrf:function(){return bats.region==='trf';},isOpt:function(){return bats.region==='opt';},isByx:function(){return bats.region==='byx';},isEdgx:function(){return bats.region==='edgx';},isEdga:function(){return bats.region==='edga';},startsWith:function(str,starts){if(starts==='')return true;if(str==null||starts==null)return false;str=String(str);starts=String(starts);return str.length>=starts.length&&str.slice(0,starts.length)===starts;},endsWith:function(str,ends){if(ends==='')return true;if(str==null||ends==null)return false;str=String(str);ends=String(ends);return str.length>=ends.length&&str.slice(str.length-ends.length)===ends;},messages:{'matched volume':{title:'Matched Volume',icon:'INFO',modal:false,msg:'Volume that is matched internally on the Bats book.'+' All volume that is not routed.'}},txtMap:{'key':'value'},createTagAttributes:function(obj){var retVal=[],k,v;for(k in obj){if(obj.hasOwnProperty(k)){v=obj[k];if(typeof v==="string"){retVal.push(String.format("{0}=\"{1}\"",k,v));}else{retVal.push(String.format("{0}={1}",k,v));}}} return retVal.join(' ');},getRandomCssRgbValue:function(key,min,max){bats.RandomCssRgbValues=bats.RandomCssRgbValues||{};function getRandomInt(min,max){return Math.floor(Math.random()*(max-min))+min;} var retVal=bats.RandomCssRgbValues[key];if(!retVal){retVal=bats.format("rgb({0}, {1}, {2})",getRandomInt(min,max),getRandomInt(min,max),getRandomInt(min,max));bats.RandomCssRgbValues[key]=retVal;} console.log('getRandomCssRgbValue: key=%s, retVal=%s',key,retVal);return retVal;},openWin:function(config){config=typeof config==="object"?config:{};defaults={name:"_blank",src:"",scrollbars:0,menubar:0,toolbar:0,status:0,resizable:0,location:0};for(var key in defaults){if(!config[key]){config[key]=defaults[key];}} config.name=config.name.replace(/\W/ig,"_");if(config.center){x=window.screenX?window.screenX:window.screenLeft;y=window.screenY?window.screenY:window.screenTop;x=Math.floor(x/screen.width)*screen.width;y=Math.floor(y/screen.height)*screen.height;config.left=(screen.width-config.width)/2+x;config.top=(screen.height-config.height)/2+y;} props=((config.width>0)?",width="+config.width:"")+ ((config.height>0)?",height="+config.height:"")+ ((config.top>0)?",top="+config.top:"")+ ((config.left>0)?",left="+config.left:"")+ ((config.scrollbars===0)?",scrollbars=0":",scrollbars=1")+ ((config.menubar===0)?",menubar=0":",menubar=1")+ ((config.toolbar===0)?",toolbar=0":",toolbar=1")+ ((config.status===0)?",status=0":",status=1")+ ((config.resizable===0)?",resizable=0":",resizable=1")+ ((config.location===0)?",location=0":",location=1");props=props.substring(1,props.length);return window.open(config.src,config.name,props);},wait:function(msecs){var start=new Date().getTime();var cur=start;while(cur-start<msecs){cur=new Date().getTime();}},roundNumber:function(val,rlength){var retVal;if(!rlength){rlength=2;} retVal=Math.round((val*Math.pow(10,rlength))+Math.pow(10,4*(-rlength)))/Math.pow(10,rlength);return retVal;},formatNumericComma:function(v){v+='';parts=v.split('.');var whole=parts[0];var dec=parts.length>1?'.'+parts[1]:'';var r=/(\d+)(\d{3})/;while(r.test(whole)){whole=whole.replace(r,'$1'+','+'$2');} return whole+dec;},formatCondensedNumber:function(v){if(v>1000000000){return bats.comma_two_dec(v/1000000000)+'B';}else if(v>1000000){return bats.comma_two_dec(v/1000000)+'M';}else if(v>1000){return bats.comma_two_dec(v/1000)+'k';} return v;},comma_zero_dec:function(val){var parts=(''+Math.round(val)).split("."),formattedValue;if(parts.length===0){return"0";} if(Number(val)===0){formattedValue=val;} else if(Number(val)<=0&&Number(parts[0])===0){formattedValue='-0';}else{if(parts[0]===""){parts[0]="0";} formattedValue=bats.formatNumericComma(parts[0]);} return formattedValue;},comma_two_dec:function(val){var parts=(""+(Math.round(val*100)/100)).split(".");switch(parts.length){case 0:return"0.00";case 1:parts.push("0");} if(parts[0]===""){parts[0]="0";} if(parts[1]===""){parts[1]="0";} if(parts[1].length===1){parts[1]+="0";} return bats.comma_zero_dec(parts[0])+"."+parts[1].charAt(0)+parts[1].charAt(1);},comma_four_dec_trimmed_to_two:function(val){var parts=(""+(Math.round(val*10000)/10000)).split(".");switch(parts.length){case 0:return"0.00";case 1:parts.push("00");} if(parts[0]===""){parts[0]="0";} if(parts[1]===""){parts[1]="0";} switch(parts[1].length){case 1:parts[1]+="0";break;case 2:break;case 3:parts[1]+="0";case 4:if(parts[1].charAt(2)==='0'&&parts[1].charAt(3)==='0'){parts[1]=parts[1].slice(0,2);} break;default:parts[1]=parts[1].slice(0,4);} return bats.comma_zero_dec(parts[0])+"."+parts[1];},comma_two_dec_perc:function(val){return bats.comma_two_dec(100.0*val);},clone:function(oClone){if(typeof(oClone)!=='object'){return oClone;} if(oClone===null){return oClone;} var retVal={};for(var i in oClone){retVal[i]=bats.clone(oClone[i]);} return retVal;},extend:function(Super,Child){var s=Super.prototype,o=Child.prototype,F=function(){};f=new F();f.prototype=o;for(var i in s){if(!o.hasOwnProperty(i)){f.prototype[i]=s[i];}} Child=f;Child.prototype.superclass=s;return Child;},getListValue:function(str){var retVal=str;if(Ext.isString(str)){if(str.length>0){var delim=str[0];if(",;:|".indexOf(delim)<0){delim=',';}else{str=str.substring(1);} retVal=str.split(delim);}else{retVal=[];}} return retVal;},XMLtoString:function(elem){var serializer=null;var serialized;try{serializer=new XMLSerializer();serialized=serializer.serializeToString(elem);} catch(e){if(Ext.isIE){serialized=elem.xml;}} if(serializer!==null){serializer=null;} return serialized;},copy2clip:function(txt){var clipboard;if(!document.getElementById('ext-clipboard')){clipboard=document.createElement('textarea');clipboard.id='ext-clipboard';clipboard.style.display="none";document.body.appendChild(clipboard);} clipboard=document.getElementById('ext-clipboard');clipboard.value=txt;if(clipboard.createTextRange){var range=clipboard.createTextRange();if(range){range.execCommand('Copy');}} else{var flashcopier='flashcopier';if(!document.getElementById(flashcopier)){var divholder=document.createElement('div');divholder.id=flashcopier;document.body.appendChild(divholder);} document.getElementById(flashcopier).innerHTML='';var divinfo='<embed src="/res/flashcopier/clipboard.swf" FlashVars="clipboard='+ encodeURIComponent(clipboard.value)+'" width="0" height="0" type="application/x-shockwave-flash"></embed>';document.getElementById(flashcopier).innerHTML=divinfo;}},removeAllChildren:function(extElem){while(extElem.dom.firstChild){extElem.dom.removeChild(extElem.dom.firstChild);}},formFailure:function(frm,action){if(action.result){bats.formSuccess(frm,action);}else{bats.failureHandler(action.response.statusText);}},ajaxErrorMsg:'There was a failure while communicating with the server.',ajaxFailure:function(response,request){bats.failureHandler(response.statusText);},failureHandler:function(failureTxt){bats.showMsg({title:failureTxt,icon:'ERROR',msg:bats.ajaxErrorMsg});},formSuccess:function(frm,action,fn){var result=action.result;if(frm.msgAnim){e=frm.getEl();result.msgAnimEl=e;} bats.successHandler(result,fn);},ajaxSuccess:function(response,request,fn){var result=Ext.decode(response.responseText);bats.successHandler(result,fn);},successHandler:function(result,fn){if(result.msg){if(!result.level){result.level='INFO';} var msgCfg={icon:result.level,msg:result.msg};if(result.msgAnimEl){msgCfg.animEl=result.msgAnimEl;} if(result.title){msgCfg.title=result.title;} if(fn){msgCfg.fn=fn;} this.showMsg(msgCfg);}},formErrors:function(frm,result){if(result.errors){var errors=result.errors;var errMsg,f;for(var fieldName in errors){errMsg=errors[fieldName];f=frm.findField(fieldName);f.markInvalid(errMsg);}}},showMsg:function(config){config=config||{};if(typeof config!=='object'){config={msg:config};} var winSize=Ext.getBody().getViewSize();msgConfig={modal:true,title:'',icon:'INFO',msg:'',buttons:'OK',maxWidth:winSize.width,maxHeight:winSize.height};bats.apply(msgConfig,config);if(typeof Ext!=='object'){return alert(msgConfig.msg);} msgConfig.icon=Ext.MessageBox[msgConfig.icon];msgConfig.buttons=Ext.MessageBox[msgConfig.buttons];Ext.Msg.maxWidth=msgConfig.maxWidth;Ext.Msg.show(msgConfig);},recaptchaBatstradingComPublicKey:'6Lf3pA8TAAAAAAZm5yM5X6oulvrdLcIXkEWBjzGs',is:function(type,obj){return Object.prototype.toString.call(obj)==="[object "+type+"]";},hash:function(str){var retVal=0;if(str&&str.length>0){for(var i=0,l=str.length;i<l;i++){retVal=((retVal<<5)-retVal)+str.charCodeAt(i);}} return retVal;},csvToArray:function(strData,strDelimiter){strDelimiter=strDelimiter||",";var objPattern=new RegExp(("(\\"+strDelimiter+"|\\r?\\n|\\r|^)"+"(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|"+"([^\"\\"+strDelimiter+"\\r\\n]*))"),"gi");var arrData=[[]];var arrMatches=null;while(arrMatches=objPattern.exec(strData)){var strMatchedDelimiter=arrMatches[1];if(strMatchedDelimiter.length&&(strMatchedDelimiter!=strDelimiter)){arrData.push([]);} if(arrMatches[2]){var strMatchedValue=arrMatches[2].replace(/"/g,'');}else{var strMatchedValue=arrMatches[3];} arrData[arrData.length-1].push(strMatchedValue);} return arrData;},_getGenericTextByResponseStatusCode:function(statusCode,destination){var msg='';if(destination=='public'){switch(statusCode){case 401:msg='You are not unauthorized.';break;case 500:msg='Error communicating.';break;default:msg='Error communicating';}}else if(destination=='intranet'){switch(statusCode){case 400:msg='400: Bad Request';break;case 401:msg='401: Unauthorized';break;case 402:msg='402: Payment Required';break;case 403:msg='403: Forbidden';break;case 404:msg='404: Not Found';break;case 405:msg='405: Method Not Allowed';break;case 406:msg='406: Not Acceptable';break;case 407:msg='407: Proxy Authentication Required';break;case 408:msg='408: Request Timeout';break;case 409:msg='409: Conflict';break;case 410:msg='410: Gone';break;case 411:msg='411: Length Required';break;case 412:msg='412: Precondition Failed';break;case 413:msg='413: Payload Too Large';break;case 414:msg='414: URI Too Long';break;case 415:msg='415: Unsupported Media Type';break;case 416:msg='416: Range Not Satisfiable';break;case 417:msg='417: Expectation Failed';break;case 426:msg='426: Upgrade Required';break;case 500:msg='500: Internal Server Error';break;case 501:msg='501: Not Implemented';break;case 502:msg='502: Bad Gateway';break;case 503:msg='503: Service Unavailable';break;case 504:msg='504: Gateway Timeout';break;case 505:msg='505: HTTP Version Not Supported';break;default:msg='Error Communicating';if(statusCode!==undefined){msg+=' ('+statusCode+')';}}} return msg;},getGenericIntranetTextByResponseStatusCode:function(statusCode){return bats._getGenericTextByResponseStatusCode(statusCode,'intranet');},getGenericPublicTextByResponseStatusCode:function(statusCode){return bats._getGenericTextByResponseStatusCode(statusCode,'public');}});bats.equiv=function(){var innerEquiv;var callers=[];var parents=[];function hoozit(o){if(bats.is("String",o)){return"string";}else if(bats.is("Boolean",o)){return"boolean";}else if(bats.is("Number",o)){if(isNaN(o)){return"nan";}else{return"number";}}else if(typeof o==="undefined"){return"undefined";}else if(o===null){return"null";}else if(bats.is("Array",o)){return"array";}else if(bats.is("Date",o)){return"date";}else if(bats.is("RegExp",o)){return"regexp";}else if(typeof o==="object"){return"object";}else if(bats.is("Function",o)){return"function";}else{return undefined;}} function bindCallbacks(o,callbacks,args){var prop=hoozit(o);if(prop){if(hoozit(callbacks[prop])==="function"){return callbacks[prop].apply(callbacks,args);}else{return callbacks[prop];}}} var callbacks=function(){function useStrictEquality(b,a){if(b instanceof a.constructor||a instanceof b.constructor){return a==b;}else{return a===b;}} return{"string":useStrictEquality,"boolean":useStrictEquality,"number":useStrictEquality,"null":useStrictEquality,"undefined":useStrictEquality,"nan":function(b){return isNaN(b);},"date":function(b,a){return hoozit(b)==="date"&&a.valueOf()===b.valueOf();},"regexp":function(b,a){return hoozit(b)==="regexp"&&a.source===b.source&&a.global===b.global&&a.ignoreCase===b.ignoreCase&&a.multiline===b.multiline;},"function":function(){var caller=callers[callers.length-1];return caller!==Object&&typeof caller!=="undefined";},"array":function(b,a){var i,j,loop;var len;if(!(hoozit(b)==="array")){return false;} len=a.length;if(len!==b.length){return false;} parents.push(a);for(i=0;i<len;i++){loop=false;for(j=0;j<parents.length;j++){if(parents[j]===a[i]){loop=true;}} if(!loop&&!innerEquiv(a[i],b[i])){parents.pop();return false;}} parents.pop();return true;},"object":function(b,a){var i,j,loop;var eq=true;var aProperties=[],bProperties=[];if(a.constructor!==b.constructor){return false;} callers.push(a.constructor);parents.push(a);for(i in a){loop=false;for(j=0;j<parents.length;j++){if(parents[j]===a[i]) loop=true;} aProperties.push(i);if(!loop&&!innerEquiv(a[i],b[i])){eq=false;break;}} callers.pop();parents.pop();for(i in b){bProperties.push(i);} return eq&&innerEquiv(aProperties.sort(),bProperties.sort());}};}();innerEquiv=function(){var args=Array.prototype.slice.apply(arguments);if(args.length<2){return true;} return(function(a,b){if(a===b){return true;}else if(a===null||b===null||typeof a==="undefined"||typeof b==="undefined"||hoozit(a)!==hoozit(b)){return false;}else{return bindCallbacks(a,callbacks,[b,a]);}})(args[0],args[1])&&arguments.callee.apply(this,args.splice(1,args.length-1));};return innerEquiv;}();bats.dom={addClass:function(htmlElement,classNames){var currentClasses=htmlElement.className.split(' ');if(typeof classNames==='string'){classNames=[classNames];} for(var i=0,len=classNames.length;i<len;i++){if(currentClasses.indexOf(classNames[i])===-1){htmlElement.className+=' '+classNames[i];}}},removeClass:function(htmlElement,classNames){console.log(classNames);var currentClasses=htmlElement.className.split(' '),indexOf;if(typeof classNames==='string'){classNames=[classNames];} for(var i=0,len=classNames.length;i<len;i++){indexOf=currentClasses.indexOf(classNames[i]);if(indexOf>=0){currentClasses.splice(indexOf,1);}} htmlElement.className=currentClasses.join(' ');}};window.debug=(function(){var window=this,aps=Array.prototype.slice,con=window.console,that={},log_level=9,log_methods=['error','warn','info','debug','log'],pass_methods='assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace'.split(' '),idx=pass_methods.length;while(--idx>=0){(function(method){that[method]=function(){log_level!==0&&con&&con[method]&&con[method].apply(con,arguments);};})(pass_methods[idx]);} idx=log_methods.length;while(--idx>=0){(function(idx,level){that[level]=function(){if(!con||!is_level(idx)){return;} var args=aps.call(arguments);if(con[level]&&typeof con[level]==="function"){con[level].apply(con,args);}else{con.log(args);}};})(idx,log_methods[idx]);} that.setLevel=function(level){log_level=typeof level==='number'?level:9;};function is_level(level){return log_level>0?log_level>level:log_methods.length+log_level<=level;} return that;})();
 Ext.BLANK_IMAGE_URL='/res/_img/general/blank.gif';Ext.Ajax.timeout=60000;Ext.Ajax.disableCaching=false;Ext.QuickTips.init();Ext.useShims=true;Ext.majorVersion=Ext.versionDetail?Ext.versionDetail.major:Ext.getVersion?Ext.getVersion('extjs').major:0;Ext.isExt3=Boolean(Ext.majorVersion===3);Ext.isExt4=Boolean(Ext.majorVersion===4);Ext.isExt4plus=Boolean(Ext.majorVersion>=4);Ext.isExt5=Boolean(Ext.majorVersion===5);Ext.isExt5plus=Boolean(Ext.majorVersion>=5);Ext.isExt6=Boolean(Ext.majorVersion===6);Ext.isExt6plus=Boolean(Ext.majorVersion>=6);Ext.ns('bats.Date');var ES=String;if(Ext.isExt3){Ext.util.MixedCollection.prototype.getByKey=Ext.util.MixedCollection.prototype.key;bats.apply(bats,{defer:function(fn,millis,scope,args,appendArgs){return fn.defer(millis,scope,args,appendArgs);},bind:function(fn,scope,args,appendArgs){return fn.createDelegate(scope,args,appendArgs);},throttled:function(fn,interval,scope){var lastCallTime,elapsed,lastArgs,timer,execute=function(){fn.apply(scope||this,lastArgs);lastCallTime=Date.now();};return function(){elapsed=Date.now()-lastCallTime;lastArgs=arguments;clearTimeout(timer);if(!lastCallTime||elapsed>=interval){execute();}else{timer=setTimeout(execute,interval-elapsed);}};},format:function(str){return String.format.apply(str,arguments);},markup:function(spec){return Ext.DomHelper.markup(spec);},arrayContains:function(array,item){for(var i=0;i<array.length;i++){if(array[i]===item){return true;}} return false;},arrayRemove:function(array,item){return array.remove(item);},parseDate:Date.parseDate,formatDate:function(dt,fmt){return dt.format(fmt);}});bats.Date.parseDate=Date.parseDate;(function(){var ua=navigator.userAgent.toLowerCase(),check=function(r){return r.test(ua);},isIE10=Ext.isIE&&check(/msie 10/),isIE6=Ext.isIE&&!Ext.isIE7&&!Ext.isIE8&&!Ext.isIE9&&!isIE10;Ext.isIE6=isIE6;Ext.isIE10=isIE10;}());} if(Ext.isExt5plus){function df(events){console.log('deprecated addEvents(), evt=%o, this=%o',events,this);} Ext.mixin.Observable.prototype.addEvents=df;Ext.util.Observable.prototype.addEvents=df;Ext.Component.prototype.addEvents=df;} if(Ext.isExt4plus){ES=Ext.String;Ext.applyIf(String,{format:Ext.String.format});if(Ext.isExt4){Ext.dom.CompositeElementLite.prototype.addClass=Ext.dom.CompositeElementLite.prototype.addCls;Ext.dom.AbstractElement.prototype.addClass=Ext.dom.AbstractElement.prototype.addCls;Ext.dom.AbstractElement.prototype.hasClass=Ext.dom.AbstractElement.prototype.hasCls;Ext.dom.AbstractElement.prototype.removeClass=Ext.dom.AbstractElement.prototype.removeCls;} Ext.util.MixedCollection.prototype.itemAt=Ext.util.MixedCollection.prototype.getAt;Ext.util.MixedCollection.prototype.item=Ext.util.MixedCollection.prototype.getByKey;Ext.util.MixedCollection.prototype.key=Ext.util.MixedCollection.prototype.getByKey;Ext.util.MixedCollection.prototype.keySort=Ext.util.MixedCollection.prototype.sortByKey;Ext.util.JSON=Ext.JSON;bats.apply(bats,{defer:Ext.Function.defer,bind:Ext.Function.bind,throttled:Ext.Function.createThrottled,format:Ext.String.format,markup:function(spec){return Ext.DomHelper.createHtml(spec);},arrayContains:function(array,item){return Ext.Array.contains(array,item);},arrayRemove:function(array,item){return Ext.Array.remove(array,item);},arrayInsert:function(array,index,items){return Ext.Array.insert(array,index,items);},parseDate:Ext.Date.parse,formatDate:Ext.Date.format});bats.Date.parseDate=Ext.Date.parseDate;Ext.define('bats.MarketToggle.mixins.MenuItem',{toggleElementCls:'market-toggle-menu',menuItemCls:'menuitem',menuItemSelectedCls:'selected',setEventHandlers:function(options){Ext.apply(this,options);this.appEl.on({'click':{fn:this.getSelectedMenuItem,scope:this}});},getSelectedMenuItem:function(evt,el){var extEl=Ext.get(el),marketType,toggleElementSelector='.'+this.toggleElementCls,menuItemSelector='.'+this.menuItemCls,toggleMenuEl=extEl.findParent(toggleElementSelector,3,true),toggleMenuItemEl=extEl.findParent(menuItemSelector,2,true);if(!Ext.isEmpty(toggleMenuEl)&&!Ext.isEmpty(toggleMenuItemEl)){marketType=toggleMenuItemEl.getAttribute('marketType');this.appEl.select(toggleElementSelector+' '+menuItemSelector).removeCls(this.menuItemSelectedCls);Ext.fly(toggleMenuItemEl).addCls(this.menuItemSelectedCls);if(!Ext.isEmpty(marketType)){evt.stopEvent();this.fireEvent('marketToggleEvent',marketType);}}}});Ext.define('bats.MarketToggle.mixins.ComboBox',{setEventHandlers:function(){var comboBoxElement=this.appEl.select('select.market-toggle-menu',true).item(0),self=this;comboBoxElement.dom.onchange=function(){self.getSelectedOption(this);};},getSelectedOption:function(combobox){var marketType=combobox.options[combobox.selectedIndex].value;this.fireEvent('marketToggleEvent',marketType);}});Ext.define('bats.MarketToggle',{id:undefined,toggleType:'menu',mixins:{observable:'Ext.util.Observable',menuItem:'bats.MarketToggle.mixins.MenuItem',combobox:'bats.MarketToggle.mixins.ComboBox'},constructor:function(config){this.mixins.observable.constructor.call(this,config);this.addEvents('marketToggleEvent');if(Ext.isDefined(this.id)){this.appEl=Ext.get(this.id);if(!Ext.isEmpty(this.appEl)){switch(this.toggleType){case'menu':this.mixins.menuItem.setEventHandlers.call(this,this.config);break;case'combobox':this.mixins.combobox.setEventHandlers.call(this,this.config);break;default:return false;}}}},listeners:{marketToggleEvent:function(marketType){this.marketToggleEvent(marketType);}},marketToggleEvent:function(){return false;}});} Ext.captureEvents=function(cmp,cmpName){var fmtstr=Ext.isChrome?'EVENT: %s - %s, arguments: %O':'EVENT: %s - %s, arguments: %o';if(window.console){if(!cmpName){cmpName=cmp.id;} Ext.util.Observable.capture(cmp,function(evtName){clog(fmtstr,cmpName,evtName,arguments);return true;});}};if(Ext.isExt3){Ext.Container.prototype.findComponent=function(id){var retVal=this.getComponent(id);if(!retVal){var idx,items=this.items.getRange(),item;if(items){for(idx=0;idx<items.length;idx++){item=items[idx];if(item.findComponent){retVal=item.findComponent(id);if(retVal){break;}}}}} return retVal;};Ext.form.PriceField=Ext.extend(Ext.form.NumberField,{initComponent:function(){var me=this,dp=this.decimalPrecision||2;me._pricePrecision=dp;me.decimalPrecision=dp+1;Ext.form.PriceField.superclass.initComponent.call(this);},getValue:function(){var me=this,retVal=Ext.form.PriceField.superclass.getValue.call(me),parts=retVal.toString().split(me.decimalSeparator);if(parts.length>1){if(parts[1].length>me._pricePrecision){retVal=parts[0]+me.decimalSeparator+parts[1].substr(0,me._pricePrecision);me.setRawValue(retVal);}} return retVal;}});Ext.reg('pricefield',Ext.form.PriceField);Ext.form.TimestampField=Ext.extend(Ext.form.TriggerField,{triggerClass:'x-form-timestamp-trigger',width:144,format:'Y-m-d H:i:s',onTriggerClick:function(){var dt=new Date();this.setValue(dt.format(this.format));},validator:function(val){return Date.parseDate(val,this.format)?true:false;}});Ext.reg('timestampfield',Ext.form.TimestampField);Ext.Panel.prototype.setTitleToolbar=function(titletbar){if(titletbar){if(Ext.isArray(titletbar)){this.titleToolbar=new Ext.Toolbar({cls:'b-titletoolbar',items:titletbar});}else if(typeof titletbar.addClass==='function'){this.titleToolbar=titletbar;this.titleToolbar.addClass('b-titletoolbar');}else{titletbar.cls='b-titletoolbar';this.titleToolbar=new Ext.Toolbar(titletbar);} if(this.header){this.titleToolbar.render(this.header);this.titleToolbar.ownerCt=this;this.header.addClass('b-panel-header-titletoolbar');}}};if(typeof Ext.Panel.prototype._afterRender==='undefined'){Ext.Panel.prototype._afterRender=Ext.Panel.prototype.afterRender;Ext.Panel.prototype.afterRender=function(){Ext.Panel.prototype._afterRender.call(this);if(this.titletbar){this.setTitleToolbar(this.titletbar);}};} if(!Ext.form.Field.setLabel){Ext.override(Ext.form.Field,{setLabel:function(text){var r=this.getEl().up('div.x-form-item');r.dom.firstChild.innerHTML=String.format('{0}',text);}});} if(!Ext.form.Field.setBoxLabel){Ext.override(Ext.form.Field,{setBoxLabel:function(text){var r=this.getEl().next();r.dom.innerHTML=String.format('{0}',text);}});} bats.MarketToggle=function(config){config=config||{};this.addEvents({'marketToggleEvent':true});Ext.apply(this,config);this.init();};Ext.extend(bats.MarketToggle,Ext.util.Observable,(function(){return{constructor:function(config){this.listeners=config.listeners;bats.EnvironmentToggle.superclass.constructor.call(this,config);},init:function(){if(this.id&&this.id!=='undefined'){Ext.util.Observable.apply(this);var widget=Ext.fly(this.id);this.getMenuItems(widget);}},listeners:{marketToggleEvent:function(marketType){this.marketToggleEvent(marketType);}},getMenuItems:function(el){this.menuItems=Ext.select('#'+el.dom.id+' .market-toggle-menu .menuitem',true).elements;for(var i=0,len=this.menuItems.length;i<len;i++){var marketType=this.menuItems[i].getAttribute('marketType');this.menuItems[i].on({'click':this.mouseClick.createDelegate(this,[i,marketType]),scope:this,stopEvent:true});}},mouseClick:function(clickedItemIndex,marketType){this.deactivateMenuItem();this.activateMenuItem(this.menuItems[clickedItemIndex]);if(marketType!=='undefined'){this.fireEvent('marketToggleEvent',marketType);}},deactivateMenuItem:function(){for(var i=0,len=this.menuItems.length;i<len;i++){this.menuItems[i].removeClass('selected');}},activateMenuItem:function(el){el.addClass('selected');},marketToggleEvent:function(){return false;}};}()));} Ext.LoadMask.prototype.showMsg=function(msg){var me=this,origMsg=me.msg;me.msg=msg;me.show();bats.defer(function(){me.msg=origMsg;},100,me);};bats.MsgBus=Ext.extend(Ext.util.Observable,{constructor:function(config){Ext.apply(this,config||{});if(!this.name){throw'The MsgBus "name" is a required config property.';} if(Ext.isDefined(bats.MsgBus._instances[this.name])){throw'A MsgBus with the name, "'+this.name+'", has already been created.';} this._props={};bats.MsgBus.superclass.constructor.call(this);bats.MsgBus._instances[this.name]=this;this.addEvents('propertychanged');this.subscribe=this.on;this.unsubscribe=this.un;this.destroy=this.purgeListeners;},publish:function(subject){this.events[subject]||this.addEvents(subject);return this.fireEvent.apply(this,arguments);},setProperty:function(propName,newVal,oldVal,src){this._props[propName]=newVal;return this.fireEvent('propertychanged',propName,newVal,oldVal,src);},getProperty:function(propName,defVal){return Ext.isDefined(this._props[propName])?this._props[propName]:defVal;}});bats.MsgBus.get=function(name){name=String(name||'global');if(!Ext.isDefined(bats.MsgBus._instances[name])){bats.MsgBus._instances[name]=new bats.MsgBus({name:name});} return bats.MsgBus._instances[name];};bats.MsgBus._instances={};bats.apply(bats,{getBrowserType:function(){return Ext.isIE?'ie':Ext.isChrome?'chrome':Ext.isGecko?'gecko':Ext.isSafari?'safari':Ext.isOpera?'opera':Ext.isAir?'air':'surprise';},hideQuickTip:function(){var qt=Ext.QuickTips.getQuickTip();if(qt){qt.hide();}},registerTooltips:function(cnr,recursive){var items=cnr.items.getRange(),item,i,l,cfg;for(i=0,l=items.length;i<l;i++){item=items[i];if(item.tooltip){cfg=item.tooltip;if(Ext.isString(cfg)){cfg={html:cfg};} Ext.create('Ext.tip.ToolTip',Ext.applyIf({target:item.getId()},cfg));} if(recursive&&item.isContainer){bats.registerTooltips(item,recursive);}}},requiredFieldLabel:'<span class="required-field-label" data-qtip="Required">*</span>',includeJS:function(url){var con=new Ext.data.Connection();con.request({url:url+'?ts='+new Date().format('Ymd_his'),method:'GET',callback:function(opts,success,response){if(!success){Ext.MessageBox.alert('Error',success?response.responseText:'Error loading javascript!');return;} var o=document.getElementById('script_'+url);if(o){o.parentNode.removeChild(o);} var s=document.createElement('script');s.setAttribute('id','script_'+url);s.setAttribute('type','text/javascript');s.appendChild(document.createTextNode(response.responseText));document.getElementsByTagName('head')[0].appendChild(s);}});},postFormToNewWindow:function(windowConfig,params,url){var win=bats.openWin(windowConfig);win.focus();var formParams=[];for(var param in params){if(params.hasOwnProperty(param)){formParams.push({xtype:'hidden',itemId:param,name:param,value:params[param]});}} var f=new Ext.form.FormPanel({standardSubmit:true,hidden:true,renderTo:Ext.getBody(),items:formParams});var form=f.getForm(),formDom;if(Ext.isExt3){formDom=form.getEl().dom;formDom.action=url;formDom.target=windowConfig.name;form.submit();Ext.destroy(f);}else{form.submit({method:'POST',target:windowConfig.name,url:url,success:function(){Ext.destroy(f);},failure:function(){Ext.destroy(f);}});} return win;},getServerTzOffset:function(strServerTime){var retVal=0;try{var d1=Date.parseDate(strServerTime.substr(0,19),'Y-m-d H:i:s');var d2=Date.parseDate(strServerTime,'Y-m-d H:i:s.uP');retVal=Math.round(d2.getElapsed(d1)/1000/60/60);if(d2>d1){retVal=retVal*-1;}}catch(exc){} return retVal;},toggleClassDisplay:function(ruleId,newDisplay){try{var curDisplay='';var rule=Ext.util.CSS.getRule(ruleId);if(rule){curDisplay=rule.style.display;}else{var cssText=ruleId+'{display: '+(newDisplay?newDisplay:curDisplay)+';}';Ext.util.CSS.createStyleSheet(cssText,ruleId);if(newDisplay){return;} rule=Ext.util.CSS.getRule(ruleId);if(!rule){window.status='Unable to create stylesheet rule for '+ruleId;return;} var els=Ext.select(ruleId);if(els&&els.getCount()>0){var el=els.item(0);curDisplay=el.getStyle('display');}} if(!newDisplay){if(curDisplay==='none'){try{var tmp=ruleId.toLowerCase();if(tmp.substring(0,2)==='tr'){newDisplay='table-row';}else if(tmp.substring(0,4)==='span'){newDisplay='inline';}else{newDisplay='block';}}catch(exc2){alert(exc2);newDisplay='block';}}else{newDisplay='none';}} rule.style.display=newDisplay;}catch(exc){alert(exc);}},showMsg:function(config){if(Ext.isString(config)){config={msg:config};} var winSize=Ext.getBody().getViewSize();config.msg=String.format('<div style="max-height: {0}px; overflow: auto;">{1}</div>',config.maxHeight?config.maxHeight:Math.max(100,winSize.height-120),config.msg);config.icon=Ext.Msg[config.icon]||config.icon||Ext.Msg.INFO;config.buttons=Ext.Msg[config.buttons]||config.buttons||Ext.Msg.OK;Ext.Msg.show(Ext.applyIf(config,{modal:true,title:'',minWidth:250,maxWidth:winSize.width}));},showWarningMsg:function(config){if(Ext.isString(config)){config={msg:config};} bats.showMsg(Ext.applyIf(config,{title:'Warning',icon:Ext.Msg.WARNING}));},showSuccessMsg:function(config){if(Ext.isString(config)){config={msg:config};} bats.showMsg(Ext.applyIf(config,{title:'Success'}));},showErrorMsg:function(config){if(Ext.isString(config)){config={msg:config};} if(!config.response){if(config.error&&config.error.response){config.response=config.error.response;}else if(config._response){config.response=config._response;}} config.title=config.title||'Error';config.icon=config.icon||Ext.Msg.ERROR;if(config.response){var msg='An AJAX error occurred. ',response=config.response,options=config.options,status=response.status,statusText;if(status===404){msg+='404: url not found!';if(options){msg+='  url='+options.url;}}else{if(response.statusText){if(status===420){statusText='ClientParameterError';}else{statusText=response.statusText;} msg+=status+': "'+statusText+'"';} if(response.responseText){msg+='<br/>'+response.responseText;} if(config.bTimeoutOk&&!(status===404||status===500)){msg+='<br/>HTTP response code = '+status+'<br/>This error is possibly just a timeout error because the request is taking too <br/>'+'long to process.  If so, than the request is still executing on the server.  Check <br/>'+'the logviewer to see the progress of the request and if any errors actually <br/>'+'occurred on the server.';}} if(config.msg){msg+='<br/><br/>'+config.msg;} config.msg=msg;} bats.showMsg(config);},_zeroClipboard:null,_c2cPanel:null,copyToClipboard:function(txt){if(!bats._zeroClipboard){var clip=new ZeroClipboard();clip.on('load',function(zc,args){clog('Clipboard is ready! ',args);});clip.on('noflash',function(){alert('Flash is not supported!');});clip.on('wrongflash',function(zc,args){alert('The currently installed version of flash is '+args.flashVersion+'. ZeroClipboard only supports version 10 and above!');});clip.on('dataRequested',function(zc,args){clog('Data requested! ',zc,args);bats._zeroClipboard.setText(txt);});clip.on('complete',function(zc,args){clog('Clipboard is complete! ',zc,args);bats._c2cPanel.hide();});bats._zeroClipboard=clip;} if(!bats._c2cPanel){bats._c2cPanel=new bats.CopyToClipboardPanel({value:txt,renderTo:Ext.getBody()});Ext.captureEvents(bats._c2cPanel,'C2C');} bats._zeroClipboard.setText(txt);bats._c2cPanel.value=txt;bats._c2cPanel.show();},setEqualColHeights:function(parentEl,columnCls,options){if(parentEl.select('.'+columnCls,true).elements.length>0){var columns=parentEl.select('.'+columnCls,true).elements,maxHeight=0,i,len,column;for(i=0,len=columns.length;i<len;i++){column=Ext.get(columns[i]);if(column.getHeight()>maxHeight){maxHeight=column.getHeight();if(Ext.isDefined(options)){if(options.hasOwnProperty('contentHeight')){maxHeight=column.getHeight(true);}}}} for(i=0,len=columns.length;i<len;i++){column=Ext.get(columns[i]);column.setHeight(maxHeight);}}},execAjaxScript:function(result){if(!result.js){return;} var js=result.js;if(!bats.scriptsProcessed){bats.scriptsProcessed=[];} if(bats.scriptsProcessed.indexOf(js)>-1){return;} bats.scriptsProcessed.push(js);var s=String.format('<scri'+'pt type="text/javascript" src="{0}"></sc'+'ript>',js);if(!bats.scriptDiv){bats.scriptDiv=Ext.getBody().createChild({style:'display:hidden;'});} this.scriptDiv.update(s,true);},getTTL:function(val){if(Ext.isNumber(val)){return val;} var millis=new Date(new Date(val)/1+bats.clientOffsetMillis)-new Date();if(millis>1000*60*5){return Math.round(millis/2);} return millis;},shortNum:function(v,k){if(v>=1000000000){return String.format('{0}B',Ext.util.Format.round(v/1000000000,2));}else if(v>=1000000){return String.format('{0}M',Ext.util.Format.round(v/1000000,2));} if(k&&v>=1000){return String.format('{0}K',Ext.util.Format.round(v/1000,2));} return Ext.util.Format.number(v,'0,000');},parseDelimitedList:function(value,delimiter){if(Ext.isString(value)){delimiter=delimiter||',';value=value.split(delimiter);} if(Ext.isArray(value)){var s,tmp=value;value=[];for(var idx=0;idx<tmp.length;idx++){s=tmp[idx].trim();if(s.length>0){value.push(s);}} if(value.length<1){value=null;}} return value;},parseDateFromOrderId:function(orderId){var oid=orderId.substr(1),batsEpoch=new Date(2006,0,1),b2Oid=String.leftPad(parseInt(oid,36).toString(2),64,'0'),b2DaysSinceBatsEpoch=b2Oid.substr(8,14),b10DaysSinceBatsEpoch=parseInt(b2DaysSinceBatsEpoch,2),retVal=batsEpoch.add(Date.DAY,b10DaysSinceBatsEpoch);return retVal;}});bats.getValuesMaxDecimalPrecision=function(args){var values=Ext.isArray(args)?args:arguments,i,l,parts,retVal=0;for(i=0,l=values.length;i<l;i++){parts=String(Number(values[i])).split('.');if(parts.length>1){if(parts[1].length>retVal){retVal=parts[1].length;}}} return retVal;};bats.getPricePrecision=function(regionOrMaxPrecision,actualPrecision){var retVal=Number(regionOrMaxPrecision);if(!retVal){retVal=4;if(bats.arrayContains(['mtf','alpha','trf','scc'],regionOrMaxPrecision)){retVal=7;}} if(Ext.isDefined(actualPrecision)){retVal=Math.min(actualPrecision+actualPrecision%2,retVal);} retVal=Math.max(retVal,2);return retVal;};bats.formatPrice=function(val,precision){if(!Ext.isDefined(precision)){precision=bats.getPricePrecision(bats.region);}else if(isNaN(Number(precision))){precision=bats.getPricePrecision(precision);} var format='0,0.'+'0000000000'.substr(0,precision+1);var retVal=Ext.util.Format.number(val,format);retVal=retVal.substr(0,retVal.length-1);return retVal;};if(Ext.isExt4plus){bats.FieldHighlighter=function(){var fld,task;var pub={init:function(f){fld=f;fld.on('change',function(){pub.setHilite();});},setHilite:function(){if(!task){task=new bats.SingleTask({timeout:3000,fn:pub.resetHilite,scope:pub});return;} fld.addCls('fld-hilite');task.start();},resetHilite:function(){fld.removeCls('fld-hilite');}};return pub;};} bats.createBatsMoneyFormatter=function(currency){return function(val){var retVal=currency+bats.comma_four_dec_trimmed_to_two(val);return retVal;};};bats.SingleTask=function(config){var id=null,paused=false;Ext.apply(this,config);var callback=function(){id=null;this.fn.apply(this.scope,this.args||[]);};var callbackd;if(Ext.isExt3){callbackd=callback.createDelegate(this);}else{callbackd=Ext.Function.bind(callback,this);} this.isStarted=function(){return!!id;};this.isPaused=function(){return paused;};this.pause=function(){paused=true;this.cancel();};this.resume=function(){paused=false;};this.restart=function(timeout,config){if(id){this.cancel();} return this.start(timeout,config);};this.start=function(timeout,config){if(id){return 0;} if(!paused){if(config){Ext.apply(this,config);} if(!timeout){timeout=this.timeout;} id=window.setTimeout(callbackd,timeout);} return id;};this.delay=this.restart;this.cancel=function(){if(id){window.clearTimeout(id);id=null;}};};bats.LoadDataTask=function(config){config.timeout=config.ttl||config.timeout;bats.LoadDataTask.superclass.constructor.call(this,config);};Ext.extend(bats.LoadDataTask,bats.SingleTask,{errCnt:0,errMaxTimeout:60000,getTTL:function(json,response){var ttl=this.timeout,retVal,errMaxTimeout;if(json){if(json.ttl&&typeof json.ttl==='number'){ttl=json.ttl;if(ttl<1000){ttl=ttl*1000;}} if(json.success){this.errCnt=0;}else{this.errCnt++;}}else{this.errCnt++;} if(this.errCnt>1){errMaxTimeout=Math.min(ttl*10,this.errMaxTimeout);retVal=Math.min(ttl*Math.pow(2,this.errCnt-1),errMaxTimeout);}else{retVal=ttl;var maxAge=60;if(ttl>maxAge*1000&&response&&typeof response.getResponseHeader==='function'){var age=response.getResponseHeader('Age');if(typeof age==='number'&&age>maxAge){var x=ttl-age*1000;retVal=Math.max(0,x)+Math.random()*5000;}}} return retVal;}});bats.CopyToClipboardPanel=Ext.extend(Ext.Container,{initComponent:function(){this.mask=new Ext.BoxComponent({cls:'ext-el-mask',style:'background: #ddf;',renderTo:Ext.getBody()});this.cls='copy2clipboard-cnr';this.btn=new Ext.Button({text:'Confirm Copy to Clipboard'});this.items=[this.btn];this.on('show',function(){this.mask.show();bats._zeroClipboard.glue(this.btn.getEl().dom);this.getEl().alignTo(this.mask.getEl(),'c-c');},this);this.on('hide',function(){this.mask.hide();},this);bats.CopyToClipboardPanel.superclass.initComponent.apply(this,arguments);}});if(Ext.isExt3){bats.EntryPanel=Ext.extend(Ext.Panel,{initComponent:function(){this.wizHeaderCfg=this.wizHeaderCfg||{};Ext.applyIf(this.wizHeaderCfg,{xtype:'container',cls:'wizard-header',autoHeight:true});this.wizBodyCfg=this.wizBodyCfg||{};Ext.applyIf(this.wizBodyCfg,{xtype:'container',border:false,cls:'wizard-body',autoHeight:true});this.cls='wizard';this.items=[this.wizHeaderCfg,this.wizBodyCfg];bats.EntryPanel.superclass.initComponent.apply(this,arguments);},getWindow:function(config){if(!this.win){config=config||{};config.layout=null;config.items=[this];this.win=new Ext.Window(config);} return this.win;}});} Ext.ux.Uppercase=Ext.extend(Ext.util.Observable,{init:function(field){field.on('render',this.onRender,this);},onRender:function(field){field.el.applyStyles({textTransform:'uppercase'});field.mon(field.el,'keyup',function(){this.setValue(this.getValue().toUpperCase());},field);}});bats.onFocusClearInputValue=function(config){config=config||{};Ext.apply(this,config);};bats.onFocusClearInputValue.prototype={txtFldObj:{},reset:true,init:function(){if(this.cls.length>0){this.getElementsToClear();}},getElementsToClear:function(){var textFldGroup=[],txtFields,tf;for(var i=0;i<this.cls.length;i++){textFldGroup.push(Ext.select('.'+this.cls[i],true));for(var y=0;y<textFldGroup.length;y++){txtFields=textFldGroup[y];for(var z=0;z<txtFields.elements.length;z++){tf=txtFields.elements[z];this.txtFldObj[tf.id]={};this.txtFldObj[tf.id].defaultValue=tf.dom.value;this.txtFldObj[tf.id].focused=false;} txtFields.on({'focus':{fn:function(evt,el){this.clearValue(el);},scope:this},'blur':{fn:function(evt,el){if(el.value===''){if(this.reset){this.resetValue(el);}}},scope:this}});}}},clearValue:function(el){if(!this.txtFldObj[el.id].focused){el.value='';this.txtFldObj[el.id].focused=true;}},resetValue:function(el){el.value=this.txtFldObj[el.id].defaultValue;this.txtFldObj[el.id].focused=false;}};bats.sendAjaxRequest=function(ajaxConfig,config){config=config||{};function myCallback(options,success,response){if(loadMask){loadMask.hide();} try{var scope=config.scope||this;var msg;if(success){var json=Ext.decode(response.responseText);if(json.success){if(config.onJsonSuccess){config.onJsonSuccess.call(scope,json,config);}else{bats.showSuccessMsg(json.statusText);}}else if(config.onJsonFailure){config.onJsonFailure.call(scope,json,config);}else{bats.showErrorMsg(json.statusText);}}else{msg='communications error with server';if(response.responseText){msg='Server error, unable to retrieve data';} if(config.onAjaxFailure){config.onAjaxFailure.call(scope,msg,config);}else{bats.showErrorMsg(msg);}}}catch(e){bats.showErrorMsg('Javascript Error: '+e);}} var loadMask=false;var loadMaskMsg=false;if(config.loadMask){if(config.loadMask.loadMask){loadMask=config.loadMask.loadMask;loadMaskMsg=config.loadMask.msg;}else{loadMask=config.loadMask;} if(loadMaskMsg){loadMask.showMsg(loadMaskMsg);}else{loadMask.show();}} this.requestUpdate=Ext.Ajax.request(Ext.apply({method:'GET',scope:this,callback:myCallback},ajaxConfig));};bats.quickmsg=function(){var msgCnr;var tplMsg=new Ext.XTemplate('<div class="msg msg-{status}"><p>{message}</p></div>',{compiled:true});function createBox(status,message){return tplMsg.apply({status:status,message:message});} return{STATUS_INFO:'I',STATUS_ERROR:'E',STATUS_WARNING:'W',show:function(status,message,timeout){if(!msgCnr){msgCnr=Ext.DomQuery.selectNode('#b-quick-msg-cnr');if(!msgCnr){msgCnr=Ext.DomHelper.insertFirst(document.body,{id:'b-quick-msg-cnr'},true);}else{msgCnr=new Ext.Element(msgCnr);}} if(!message){message=status;status='I';}else if(Ext.isNumber(message)){timeout=message;message=status;status='I';} if(!timeout){timeout=4;}else if(timeout>=1000){timeout/=1000;}else if(timeout<1){timeout=1;} var m=Ext.DomHelper.append(msgCnr,{html:createBox(status,message)},true);if(Ext.isExt3){m.slideIn('t').pause(timeout).slideOut('t',{remove:true});}else{m.slideIn('t').ghost('t',{delay:timeout*1000,remove:true});}},setMsgTemplate:function(tpl){tplMsg=tpl;}};}();if(Ext.isExt3){Ext.apply(bats,{_makeRegionSupporter:function(){Ext.override(this,{constructor:this.superclass.constructor.createInterceptor(function(){this.constructorRegionSupporter.apply(this,arguments);return true;})});}});}else{Ext.apply(bats,{_makeRegionSupporter:function(){Ext.override(this,{constructor:function(config){this.constructorRegionSupporter.apply(this,arguments);this.callParent([config]);if(this.printMRO){console.log('PMRO-%s: %o',this.region,this._pmro);console.log(' MRO-%s: %o',this.region,this._mro);}}});}});} Ext.apply(bats,{getMarketFromRegion:function(region){region=region||bats.region;var regionMap={'ecn':'bzx','mtf':'bxe','alpha':'cxe','opt':'bzo'};if(regionMap[region]){region=regionMap[region];} return region;},makeRegionSupporter:function(){Ext.override(this,{RS_REGIONS:{},isRegionSupporter:true,constructorRegionSupporter:function(config){config=config||{};var region,regionConfigs;if(config.batsEnv){region=config.batsEnv.region;}else{region=config.region||bats.region||window.region;} regionConfigs=bats.findRegionSupporterConfigs(this,region);this.region=region;for(var idx=0,regionConfig;idx<regionConfigs.length;idx++){regionConfig=regionConfigs[idx];Ext.override(this,regionConfig);}}});bats._makeRegionSupporter.call(this);},addRegionToRegionSupporter:function(klass,regionConfig){Ext.apply(klass.prototype.RS_REGIONS,regionConfig);},findRegionSupporterConfigs:function(klass,region){region=region||bats.region||bats.market;var market=bats.getMarketFromRegion(region),possibleMRO=new Ext.util.MixedCollection(),mro=[],i,k,j;region=market.toUpperCase();var regionMap={'EDGX':'EDGE','EDGA':'EDGE','EDGE':'USEQ','BZX':'USEQ','BYX':'USEQ','USEQ':['US','EQUITIES'],'BZO':'OPT','OPT':'USOPT','EXO':'USOPT','CONE':'USOPT','CTWO':'USOPT','CBOE':'USOPT','USOPT':['US','OPTIONS'],'CFE':'USFUTURES','USFUTURES':['US','FUTURES'],'BXE':['EUEQ','UKEQ'],'CXE':['EUEQ','UKEQ'],'DXE':['EUEQ','UKEQ'],'SIS':['EUEQ','UKEQ'],'EUEQ':['EU','EQUITIES'],'TRF':'EU','CEDX':'EU','USC':['US','COMMON'],'SCC':['EU','COMMON'],'UKEQ':['EU','UK','EQUITIES']},config,retVal=[];var _buildPossibleMRO=function(region){if(!region){return;} possibleMRO.add(region,region);var nextRegion=regionMap[region];if(Ext.isArray(nextRegion)){for(var i=0;i<nextRegion.length;i++){_buildPossibleMRO(nextRegion[i]);}}else{_buildPossibleMRO(nextRegion);}};_buildPossibleMRO(region);for(i=0;i<possibleMRO.getCount();i++){region=possibleMRO.get(i);config=null;if(klass.RS_REGIONS&&klass.RS_REGIONS[region]){config=klass.RS_REGIONS[region];} if(config){mro.push(region);retVal.push(config);config.market=market;config._pmro=possibleMRO.keys;config._mro=mro;if(config.regionMixins){for(j=0,k=config.regionMixins.length;j<k;j++){possibleMRO.insert(i+1,config.regionMixins[j],config.regionMixins[j]);}}}} retVal=retVal.reverse();return retVal;}});bats.WindowPopOut=function(){if(!Ext.isIE6){Ext.getBody().on({'click':{delegate:'.window-pop-out',fn:function(evt,el){evt.preventDefault();var target=Ext.get(el),winHeight=target.getAttribute('winHeight'),winWidth=target.getAttribute('winWidth'),source=target.getAttribute('href');if(!Ext.isEmpty(source)&&source!==location.href){bats.openWin({height:Ext.isEmpty(winHeight)?500:parseInt(winHeight,10),resizable:1,scrollbars:1,src:source,width:Ext.isEmpty(winWidth)?500:parseInt(winWidth,10)});}},scope:this}});}};Ext.applyIf(bats,{showBook:function(s){var qs='',src;if(typeof mkt!=='undefined'&&mkt&&mkt!=='bzx'){qs=String.format('/{0}',mkt);} src=String.format('{1}/book/{0}/',s,qs);bats.openWin({src:src,scrollbars:false,width:375,height:425});}});
 Ext.ns('bats');Ext.String.addCharacterEntities({'&#39;':"'",'&amp;':'&','&euro;':'€','&gt;':'>','&lt;':'<','&oslash;':'Ø','&ouml;':'Ö','&quot;':'"'});if(Ext.getVersion){var version=Ext.getVersion();if(version.match('4.1.3')){Ext.define('enableGroupingMenuFix',{override:'Ext.grid.feature.Grouping',onColumnHideShow:function(){var menu=this.grid.headerCt.getMenu(),groupToggleMenuItem=menu.down('#groupMenuItem');if(groupToggleMenuItem){if(this.view.headerCt.getVisibleGridColumns(true).length>1){groupToggleMenuItem.enable();}else{groupToggleMenuItem.disable();}}}});} if(version.major===4){Ext.override(Ext.dom.Element,{setHtml:function(html){return this.setHTML(html);}});Ext.override(Ext.dom.Element,{'removeClass':function(v){return Ext.dom.Element.removeCls(v);}});Ext.define('Ext.override.grid.feature.Grouping',{override:'Ext.grid.feature.Grouping',setupRowData:function(record,idx) {var me=this,data=me.refreshData,groupInfo=me.groupInfo,header=data.header,view=me.view,store=view.dataSource;me.callParent(arguments);groupInfo.name=groupInfo.renderedGroupValue=groupInfo.groupValue;if(header&&header.renderer&&header.renderer.call) groupInfo.name=groupInfo.renderedGroupValue=header.renderer.call(header.scope||view.ownerCt,groupInfo.groupValue,{},record,idx,header.getOwnerHeaderCt().getHeaderIndex(header),store,view);}});}} Ext.define('bats.mixin.AutoReloader',{config:{autoReloadDelay:60000},constructor:function(config){},reload:function(){this.load();},isAutoReloadStarted:function(){return Ext.isObject(this.taskAutoReload);},startAutoReload:function(delay){this.autoReloadDelay=delay?delay:this.autoReloadDelay;this.taskAutoReload=new Ext.util.DelayedTask(function(){this.reload();},this);this.on('load',function(){this.taskAutoReload.delay(this.autoReloadDelay);},this);this.taskAutoReload.delay(this.autoReloadDelay);},stopAutoReload:function(){if(this.taskAutoReload){this.taskAutoReload.cancel();this.taskAutoReload=null;}}});Ext.define('bats.mixin.AutoRefresh',{config:{autoRefreshDelay:60000,autoRefreshUrl:''},constructor:function(config){this.taskAutoRefresh=null;this.addEvents(['beforerefresh']);},refresh:function(options){var me=this,operation;options=options||{};options.action=options.action||'read';options.filters=options.filters||me.filters.items;options.sorters=options.sorters||me.getSorters();operation=new Ext.data.Operation(options);if(me.fireEvent('beforeautorefresh',me,operation)!==false){me.loading=true;me.proxy.read(operation,me.onProxyRefresh,me);} return me;},onProxyRefresh:function(operation){var me=this,resultSet=operation.getResultSet(),records=operation.getRecords(),successful=operation.wasSuccessful();if(successful){me.refreshRecords(records,operation);} me.loading=false;Ext.callback(operation.callback,operation.scope||me,[records,operation,successful]);if(this.taskAutoRefresh){this.taskAutoRefresh.delay(this.autoRefreshDelay);}},refreshRecords:function(records,operation){var me=this,i=0,id,newr,oldr,length=records.length;me.suspendEvents();try{for(;i<length;i++){newr=records[i];id=newr.getId();oldr=me.getById(id);if(oldr){oldr.set(newr.data);oldr.commit(true);}else{me.add(newr);}}}finally{me.resumeEvents();me.fireEvent('datachanged',me);me.fireEvent('refresh',me);}},startAutoRefresh:function(delay){this.stopAutoRefresh();this.autoRefreshDelay=delay?delay:this.autoRefreshDelay;this.taskAutoRefresh=new Ext.util.DelayedTask(function(){this.refresh();},this);this.taskAutoRefresh.delay(this.autoRefreshDelay);},stopAutoRefresh:function(){if(this.taskAutoRefresh){this.taskAutoRefresh.cancel();this.taskAutoRefresh=null;}}});Ext.define('Bats.grid.plugin.GroupSelector',{extend:'Ext.AbstractPlugin',alias:'plugin.gridgroupselector',init:function(grid){this.grid=grid;grid.on('select',this.onSelect,this);},onSelect:function(rowModel,record,index,eOpts){var store=this.grid.store;var groupStr=store.getGroupString(record);var allRecords=store.getRange(),records=[],record;for(var idx=0;idx<allRecords.length;idx++){record=allRecords[idx];if(store.getGroupString(record)===groupStr){records.push(record);}} this.grid.getSelectionModel().select(records,false,true);}});Ext.define('bats.grid.plugin.PreserveSelectionOnLoad',{extend:'Ext.AbstractPlugin',alias:'plugin.gridpreserveselectiononload',init:function(grid){this.grid=grid;grid.on('viewready',this._initStore,this);},_initStore:function(){var store=this.grid.store;if(!store){return;} store.on('beforeload',function(){this._selection=this.grid.getSelectionModel().getSelection();},this);store.on('load',function(){if(this._selection){var selection=this._selection,toBeSelected=[],store=this.grid.store,record,idx;for(idx=0;idx<selection.length;idx++){record=store.getById(selection[idx].getId());if(record){toBeSelected.push(record);}} if(toBeSelected.length>0){this.grid.getSelectionModel().select(toBeSelected);}}},this);}});Ext.define('bats.AjaxRequestHandler',{extend:'Ext.util.Observable',cfg:{interval:10000,onJsonSuccess:Ext.emptyFn},constructor:function(config){Ext.apply(this,config);this.request=null;this.paused=false;this.task=new bats.LoadDataTask({fn:this.start,scope:this,timeout:this.interval,errMaxTimeout:this.interval*10});},start:function(){if(this.loadMask){this.loadMask.show();} if(this.request){return;} this.task.cancel();this.task.resume();this.request=Ext.Ajax.request(Ext.apply({url:this.url,method:'GET',scope:this,callback:this.processAjaxResponse},Ext.isFunction(this.requestConfig)?this.requestConfig.call(this.scope):this.requestConfig));},pause:function(){this.task.pause();this.stop();},isPaused:function(){return this.task.isPaused();},stop:function(){this.task.cancel();if(this.request){Ext.Ajax.abort(this.request);this.request=null;}},processAjaxResponse:function(options,success,response){this.request=null;if(this.loadMask){this.loadMask.hide();} var msg;try{if(success){var json=Ext.JSON.decode(response.responseText);this.ttl=this.task.getTTL(json,response);if(json.success){this.onJsonSuccess.call(this.scope,json);}else{}}else{this.ttl=this.task.getTTL();}}catch(e){throw e;}finally{this.task.delay(this.ttl);}}});Ext.define('bats.BasicFormEditor',{extend:'Ext.form.Panel',requiredText:'<span style="color:red;font-weight:bold" data-qtip="Required">*</span>',initComponent:function(){if(!this.fbar){this.fbar=[this.createOkButton(),this.createCancelButton()];} if(this.wizardHeader){if(Ext.isString(this.wizardHeader)){this.wizardHeader={html:this.wizardHeader};} if(!this.dockedItems){this.dockedItems=[];} this.wizardHeader=Ext.apply(this.wizardHeader,{xtype:'container',dock:'top',cls:''});this.wizardHeader.cls+=' wizard-header';this.dockedItems.push(this.wizardHeader);} this.addEvents(['ok','cancel']);this.callParent();},createOkButton:function(){var retVal=Ext.apply(this.okBtnCfg||{},{text:'Ok',formBind:true,disabled:true,handler:function(){var form=this.getForm();if(form.isValid()){var data=form.getValues();this.fireEvent('ok',this,data);}},scope:this});return retVal;},createCancelButton:function(){var retVal=Ext.apply(this.cancelBtnCfg||{},{text:'Cancel',handler:function(){this.fireEvent('cancel',this);this.closeWindow();},scope:this});return retVal;},getWindow:function(config){if(!this._win){this._win=Ext.create('Ext.window.Window',Ext.apply(config||{},{closable:true,closeAction:'destroy',layout:'fit',items:[this],listeners:{close:function(pnl,evtOpts){this._win=null;},scope:this}}));} return this._win;},showWindow:function(config){var win=this.getWindow(config);win.show();bats.defer(win.doLayout,500,win);},closeWindow:function(){if(this._win){this._win.close();this._win=null;}}});var _CMP=Ext.container.AbstractContainer?Ext.container.AbstractContainer:Ext.container.Container;_CMP.prototype.findComponent=function(id){var retVal=this.getComponent(id);if(!retVal){var idx,cnrs=this.query('container'),cnr;if(cnrs){for(idx=0;idx<cnrs.length;idx++){cnr=cnrs[idx];if(cnr.findComponent){retVal=cnr.findComponent(id);if(retVal){break;}}}}} return retVal;};Ext.define('Ext.form.field.Month',{extend:'Ext.form.field.Date',alias:'widget.monthfield',requires:['Ext.picker.Month'],alternateClassName:['Ext.form.MonthField','Ext.form.Month'],selectMonth:null,createPicker:function(){var me=this,format=Ext.String.format;return Ext.create('Ext.picker.Month',{pickerField:me,ownerCt:me.ownerCt,renderTo:document.body,floating:true,hidden:true,focusOnShow:true,minDate:me.minValue,maxDate:me.maxValue,disabledDatesRE:me.disabledDatesRE,disabledDatesText:me.disabledDatesText,disabledDays:me.disabledDays,disabledDaysText:me.disabledDaysText,format:me.format,showToday:me.showToday,startDay:me.startDay,minText:format(me.minText,me.formatDate(me.minValue)),maxText:format(me.maxText,me.formatDate(me.maxValue)),listeners:{select:{scope:me,fn:me.onSelect},monthdblclick:{scope:me,fn:me.onOKClick},yeardblclick:{scope:me,fn:me.onOKClick},OkClick:{scope:me,fn:me.onOKClick},CancelClick:{scope:me,fn:me.onCancelClick}},keyNavConfig:{esc:function(){me.collapse();}}});},onCancelClick:function(){var me=this;me.selectMonth=null;me.collapse();},onOKClick:function(){var me=this;if(me.selectMonth){me.setValue(me.selectMonth);me.fireEvent('select',me,me.selectMonth);} me.collapse();},onSelect:function(m,d){var me=this;me.selectMonth=new Date((d[0]+1)+'/1/'+d[1]);}});
 bats.Lightbox=(function(){function getLightbox(){return document.getElementById('lightbox');} function getLightboxHtml(headerHtml,contentHtml,footerHtml,closeClass){var html='';if(!closeClass){closeClass='lightbox-close';} if(typeof headerHtml!=='undefined'&&headerHtml!==null){html='<div class="lightbox-header">'+headerHtml+'<span class="'+closeClass+'"></span>'+'</div>';} html+='<div class="lightbox-content">'+contentHtml+'</div>';if(typeof footerHtml!=='undefined'&&footerHtml!==null){html+='<div class="lightbox-footer">'+footerHtml+'</div>';} return'<div class="lightbox-container">'+html+'</div>';} function showLightbox(headerHtml,contentHtml,footerHtml,className){var lightbox=getLightbox(),html=getLightboxHtml(headerHtml,contentHtml,footerHtml);document.documentElement.classList.add('noscroll');document.body.classList.add('noscroll');if(lightbox){bats.Lightbox.close();} lightbox=document.createElement('div');lightbox.id='lightbox';lightbox.className=className?className:'lightbox';lightbox.innerHTML=html;document.body.appendChild(lightbox);var closeBtns=document.getElementsByClassName('lightbox-close');for(var i=0;i<closeBtns.length;++i){closeBtns[i].addEventListener('click',bats.Lightbox.close);} document.getElementById('lightbox').addEventListener('click',function(evt){if(evt.target.id==='lightbox'){bats.Lightbox.close();}});} function showAjaxContent(contentHtml){var ajaxContentElement=document.getElementById('lightbox-ajax-content');if(ajaxContentElement){ajaxContentElement.innerHTML=contentHtml;}} function onAjaxContentError(statusCode,responseText){var errorMsg='Oops! An unexpected error occurred.';switch(statusCode){case 401:errorMsg='Looks like you may be logged out. Try logging in again.';break;case 403:errorMsg='You are not authorized to view this page.';break;case 404:errorMsg='Page not found.';break;} showAjaxContent('<p>'+errorMsg+'</p>');} function showAjaxLightbox(headerHtml,contentUrl,footerHtml,className){var contentHtml='<div id="lightbox-ajax-content"><div class="ajax-loading"></div></div>';showLightbox(headerHtml,contentHtml,footerHtml,className);bats.Ajax.request(contentUrl,'GET',showAjaxContent,onAjaxContentError);} function getConfirmationFooter(confirmText,cancelText,closeBtnClass,confirmBtnId){if(!confirmText){confirmText='Ok';} if(!cancelText){cancelText='Cancel';} var footer='<div class="lightbox-buttons">'+'<button class="btn '+closeBtnClass+'">'+cancelText+'</button>'+'<button class="btn" id="'+confirmBtnId+'">'+confirmText+'</button></div>';return footer;} function showStandaloneConfirmation(headerHtml,contentHtml,confirmText,cancelText,onConfirmCallback,onCancelCallback){var footerHtml=getConfirmationFooter(confirmText,cancelText,'lightbox-close','lightbox-confirm-btn');showLightbox(headerHtml,contentHtml,footerHtml,'lightbox lightbox--small');var confirmBtn=document.getElementById('lightbox-confirm-btn');confirmBtn.addEventListener('click',onConfirmCallback);if(onCancelCallback){var closeBtns=document.getElementsByClassName('lightbox-close');for(var i=0;i<closeBtns.length;++i){closeBtns[i].addEventListener('click',onCancelCallback);}}} function showConfirmationWithinLightbox(headerHtml,contentHtml,confirmText,cancelText,onConfirmCallback,onCancelCallback){var footerHtml=getConfirmationFooter(confirmText,cancelText,'lightbox-confirmation-close','lightbox-confirmation-confirm-btn');var html=getLightboxHtml(headerHtml,contentHtml,footerHtml,'lightbox-confirmation-close');var confirmationLightbox=document.createElement('div');confirmationLightbox.id='lightbox-confirmation';confirmationLightbox.className='lightbox lightbox--small';confirmationLightbox.innerHTML=html;getLightbox().style.display='none';document.body.appendChild(confirmationLightbox);if(!onCancelCallback){onCancelCallback=bats.Lightbox.close;} var closeBtns=document.getElementsByClassName('lightbox-confirmation-close');for(var i=0;i<closeBtns.length;++i){closeBtns[i].addEventListener('click',onCancelCallback);} var confirmBtn=document.getElementById('lightbox-confirmation-confirm-btn');confirmBtn.addEventListener('click',onConfirmCallback);} var showLarge=function(headerHtml,contentHtml,footerHtml){showLightbox(headerHtml,contentHtml,footerHtml);};var showSmall=function(headerHtml,contentHtml,footerHtml){showLightbox(headerHtml,contentHtml,footerHtml,'lightbox lightbox--small');};var showLargeAjax=function(headerHtml,contentUrl,footerHtml){showAjaxLightbox(headerHtml,contentUrl,footerHtml);};var showSmallAjax=function(headerHtml,contentUrl,footerHtml){showAjaxLightbox(headerHtml,contentUrl,footerHtml,'lightbox lightbox--small');};var close=function(){var lightbox=getLightbox(),confirmationLightbox=document.getElementById('lightbox-confirmation');if(confirmationLightbox){confirmationLightbox.parentNode.removeChild(confirmationLightbox);} if(lightbox){lightbox.parentNode.removeChild(lightbox);document.documentElement.classList.remove('noscroll');document.body.classList.remove('noscroll');}};var confirmation=function(headerHtml,contentHtml,confirmText,cancelText,onConfirmCallback,onCancelCallback){var lightbox=getLightbox();if(lightbox){showConfirmationWithinLightbox(headerHtml,contentHtml,confirmText,cancelText,onConfirmCallback,onCancelCallback);}else{showStandaloneConfirmation(headerHtml,contentHtml,confirmText,cancelText,onConfirmCallback,onCancelCallback);}};var closeConfirmation=function(){var confirmationLightbox=document.getElementById('lightbox-confirmation');if(confirmationLightbox){confirmationLightbox.parentNode.removeChild(confirmationLightbox);} var lightbox=getLightbox();if(lightbox){lightbox.style.display='block';}else{close();}};return{showLarge:showLarge,showLargeAjax:showLargeAjax,showSmall:showSmall,showSmallAjax:showSmallAjax,confirmation:confirmation,closeConfirmation:closeConfirmation,close:close,getLightbox:getLightbox};})();
 Ext.ns('Bats');Bats.GoogleTracker=function(config){Ext.apply(this,config,{parentEl:Ext.getBody(),fileTypes:['pdf']});};Bats.GoogleTracker.prototype={addGoogleTracker:function(){if(typeof ga!=='undefined'){var elements=[],el;for(var i=0;i<this.fileTypes.length;i++){fileTypeEl=this.parentEl.select('a[href$='+this.fileTypes[i]+']',true).elements;for(var x=0;x<fileTypeEl.length;x++){elements.push(fileTypeEl[x]);}} for(var x=0;x<elements.length;x++){el=Ext.get(elements[x]);el.on('click',function(e,t){re=new RegExp("http(s?)\://[^/]*");var locationStr=t.toString().replace(re,"");ga('send','pageview',locationStr);});}}},getFileName:function(path){return path.replace(/^.*[\\\/]/,'');},sortNumber:function(a,b){return(a-b);},trackEvent:function(category,action,options){ga('send','event',category,action,options.label,options.value,options.nonInteract);},trackEventByLoadTime:function(category,action,loadTime,options){var actionName;options=(Ext.isEmpty(options))?{}:options;category=(Ext.isEmpty(category))?'Load Time':category;action=(Ext.isEmpty(action))?'':action+'-';if(Ext.isEmpty(options.histogram)){options.histogram=[1000,5000,10000,15000,30000];}else{options.histogram=options.histogram.sort(this.sortNumber);} for(var i=0,len=options.histogram.length;i<len;i++){if(loadTime<options.histogram[i]){if(i===0){actionName=action+'0-'+options.histogram[i]+'ms';break;} else{actionName=action+options.histogram[i-1]+'ms-'+options.histogram[i]+'ms';break;}} else if(i===len-1){actionName=action+'>'+options.histogram[i]+'ms';}} this.trackEvent(category,actionName,{label:options.label,value:options.value,nonInteract:options.nonInteract});},trackEventForFile:function(id,category,action,options){if(!Ext.isEmpty(ga)){if(!Ext.isEmpty(id)&&!Ext.isEmpty(category)){var el=Ext.get(id);action=(Ext.isEmpty(action))?null:action;if(Ext.isDefined(options.useFilename)&&Ext.isEmpty(action)){if(!Ext.isEmpty(el.getAttribute('src'))){action=this.getFileName(el.getAttribute('src'));} if(!Ext.isEmpty(el.getAttribute('href'))){action=this.getFileName(el.getAttribute('href'));}} el.on({click:{fn:function(v,t){ga('send','event',category,action,options.label,options.value,options.nonInteract);}}});}}}};
 Ext.ns('bats_com');Ext.define('bats_com.MainNav',{extend:'Ext.util.Observable',showCss:'nav--drop--show',selectedCss:'nav--main__item--selected',currentNavItem:undefined,activeDropDownElement:undefined,constructor:function(config){Ext.apply(this,config);this.hoverIconElements=Ext.select('.'+this.hoverIconCss,true);this.hideDropMenuTask=new bats.SingleTask({timeout:300,fn:function(){this.hide();},scope:this});bats_com.MainNav.superclass.constructor.call(this);if(Ext.get(this.id)&&Ext.get(this.targetId)){this.parentEl=Ext.get(this.id);this.targetEl=Ext.get(this.targetId);this.positionHoverIcons();this.applyEvents();}},applyEvents:function(){var clickedEl,menuItemEl,touchFlag=false;this.addEvents('touchstart');Ext.getBody().on({'click':{fn:this.clickEvent,scope:this},'touchstart':{fn:this.touchEvent,scope:this},'mouseover':{fn:function(evt,el,o){if(!Ext.supports.Touch){this.touchEvent(evt,el,o);}},scope:this}});},clickEvent:function(evt,el,o){var clickedEl=Ext.get(el);if(clickedEl.parent('.nav--drop')&&!el.getAttribute('href')){evt.preventDefault();this.show(clickedEl);}else{this.hide();}},touchEvent:function(evt,el,o){touchedEl=Ext.get(el);this.currentNavItem=touchedEl;if(touchedEl.hasCls('nav--main__item')&&touchedEl.findParent('.nav--main')){evt.preventDefault();this.setActiveDropDownElement();this.applyCustomDropDownTheme();this.show(touchedEl);this.hideDropMenuTask.pause();Ext.fly(this.id).select('button').removeCls(this.selectedCss);touchedEl.addCls(this.selectedCss);}else if(Ext.isEmpty(touchedEl.findParent('.nav--main__mega'))){if(this.hideDropMenuTask.isPaused()){this.hideDropMenuTask.resume();}else{this.hideDropMenuTask.delay();}}},setActiveDropDownElement:function(){var menuItemEl=this.currentNavItem.findParent('.js-hover-show-parent');if(!Ext.isEmpty(menuItemEl)){this.activeDropDownElement=Ext.get(menuItemEl.id+'--section');}},applyCustomDropDownTheme:function(){var newCss=this.getCustomDropDownName(this.currentNavItem),navCss='',navItemCss='';if(!Ext.isEmpty(newCss)){navCss=Ext.String.format('nav--drop-{0}',newCss);navItemCss=Ext.String.format('nav--drop-{0}__item',newCss);this.newDropDownCss=navCss;Ext.fly(this.targetId).addCls(this.newDropDownCss);this.activeDropDownElement.addCls(navItemCss);}else{this.removeCustomDropDownTheme();}},getCustomDropDownName:function(extElement){return extElement.getAttribute('data-custom-dropdown');},removeCustomDropDownTheme:function(){this.targetEl.removeCls(this.newDropDownCss);},addSelectedClassToNavItem:function(extElement){extElement.addClass('.nav--main__item--selected');},hide:function(){this.targetEl.removeCls(this.showCss);this.hoverIconElements.removeCls('v--v');Ext.select('.nav--drop__section').removeCls(this.showCss);Ext.fly(this.id).select('button').removeCls(this.selectedCss);this.removeCustomDropDownTheme();},isVisible:function(){if(this.parentEl.select('.nav--drop--show').elements.length>0){return true;} return false;},show:function(){var activeDropDownElement;if(!this.isVisible()){this.targetEl.addCls(this.showCss);if(!Ext.isEmpty(this.activeDropDownElement)){Ext.select('.nav--drop__section').removeCls(this.showCss);this.activeDropDownElement.addCls(this.showCss);}}},displayHoverIcon:function(menuEl){var iconEl=Ext.get(menuEl.select('.'+this.hoverIconCss,true).elements[0]);this.hoverIconElements.removeCls('v--v');iconEl.addCls('v--v');},positionHoverIcons:function(){var iconEl,parentEl;for(var i=0,len=this.hoverIconElements.elements.length;i<len;i++){iconEl=this.hoverIconElements.elements[i];parentEl=Ext.get(iconEl.findParent('li'));iconEl.setLeft((parentEl.getTextWidth()*0.5)-(iconEl.getWidth()*0.5));}}});
 (function(){var self={js_window_most_active:function(evt,el,o){var link,extEl=Ext.get(el);evt.preventDefault();link=extEl.getAttribute('href');if(!Ext.isEmpty(link)){bats.openWin({name:"_blank",src:link,scrollbars:1,menubar:1,toolbar:0,status:1,resizable:1,location:0,width:700,height:900});}},js_window_book_viewer:function(evt,el,o){var link,extEl=Ext.get(el);evt.preventDefault();link=extEl.getAttribute('href');if(!Ext.isEmpty(link)){bats.openWin({name:"_blank",src:link,scrollbars:1,menubar:1,toolbar:0,status:1,resizable:1,location:0,width:625,height:530});}}};function functionize(fn){return fn.replace(/-/gi,'_');} Ext.getBody().on({'click':{fn:function(evt,el,o){var cls=Ext.fly(el).getAttribute('class'),fn;if(!Ext.isEmpty(cls)){cls=cls.split(' ');for(var i=0,len=cls.length;i<len;i++){fn=functionize(cls[i]);if(Ext.isFunction(self[fn])){self[fn](evt,el,o);}}}}}});})();
 bats.GoogleSearchForm=function(formId,config){if(formId===undefined){return false;} this.formId=formId;bats.apply(this,config);this.init();};bats.GoogleSearchForm.prototype={urlToResultsPage:'/search/',baseCssCls:'search-box',init:function(){this.el=document.getElementById(this.formId);if(this.el!==undefined&&this.el!==null){this.attachEvents(this.el);}},attachEvents:function(el){var submitBtnCls=this.baseCssCls+'__submit-btn',inputCls=this.baseCssCls+'__field',submitBtnEl=el.getElementsByClassName(submitBtnCls)[0],searchFieldEl=el.getElementsByClassName(inputCls)[0],me=this;if(submitBtnEl!==undefined&&submitBtnEl!==null&&searchFieldEl!==undefined){submitBtnEl.addEventListener('click',function(){me.submitSearch(searchFieldEl.value);});submitBtnEl.addEventListener('touchend',function(){me.submitSearch(searchFieldEl.value);});} if(searchFieldEl!==undefined&&searchFieldEl!==null){searchFieldEl.addEventListener('keypress',function(e){if(e.keyCode===13){e.preventDefault();me.submitSearch(this.value);}});}},submitSearch:function(searchQuery){if(searchQuery!==''&&searchQuery!==undefined){window.location=this.generatePath(searchQuery);}},generatePath:function(searchQuery){var queryString='?q='+encodeURIComponent(searchQuery);return''.concat(location.origin,this.urlToResultsPage,queryString);}};
 (function(){initCurrentPage('.nav_mobile');initCurrentPage('#side-navigation');})();function openSubmenu(who){var myElement=Ext.get(who);if(myElement==null){myElement=Ext.get(this);} myElement.toggleCls('menu-arrow--expanded');var myMenu=Ext.get(myElement.up('li').first('ul').dom);myMenu.toggleCls('submenumobile--expanded');} function openSearch(){var searchElement=Ext.get('search-tool');searchElement.removeCls('search-tool--hidden');searchElement.dom.style.top='0';searchElement.dom.style.opacity='100';} function closeSearch(){var searchElement=Ext.get('search-tool');searchElement.addCls('search-tool--hidden');searchElement.dom.style.top='-100px';searchElement.dom.style.opacity='0';} function toggleDrawer(){var drawerMenu=Ext.get('drawer'),closeButton=Ext.get('close-button');drawerMenu.toggleCls('drawer-menu--opened');closeButton.toggleCls('close-button--show');} function initCurrentPage(who){var myPath,myTarget,elements,upUl,upOne,upUlTwo,upTwo,upUlThree,upThree,upUlFour,upFour,whoToActivate,urlString,urlArray;whoToActivate=who;myPath=location.pathname;urlString=location.href;urlArray=urlString.split('?');if(urlArray[1]){myPath+='?'+urlArray[1];} myTarget=Ext.get(Ext.query(whoToActivate+' a[href="'+myPath+'"]')[0]);if(!myTarget){elements=Ext.query(whoToActivate+' a[href]');if(elements){elements=elements.filter(function(el){return urlString.startsWith(el.href);});if(elements&&elements.length>0){elements.sort(function(el1,el2){return el2.href.length-el1.href.length;});myTarget=Ext.get(elements[0]);}}} if(!myTarget){return;} myTarget.addCls('nav_mobile_selected');upUl=myTarget.up('ul');if(!upUl){return;} upOne=upUl.up('li');if(!upOne){return;} openSubmenu(upOne.first('div').dom);upUlTwo=upOne.up('ul');upTwo=upUlTwo.up('li');if(!upTwo){return;} openSubmenu(upTwo.first('div').dom);upUlThree=upTwo.up('ul');upThree=upUlThree.up('li');if(!upThree){return;} openSubmenu(upThree.first('div').dom);upUlFour=upUlThree.up('ul');upFour=upUlFour.up('li');if(!upFour){return;} openSubmenu(upFour.first('div').dom);}
 bats.PrivacyConsent=function(config){if(config===undefined||config===null){return false;} for(var i in config){this[i]=config[i];} this.init();};bats.PrivacyConsent.prototype={expire:new Date(3006,11,31),init:function(){if(typeof this.cookieObj.name!==undefined&&this.cookieObj.name!==null&&this.cookieObj.name){if(!this.isCookieSet()){this.buildDom();} this.container=document.getElementById('privacy-alert');if(this.container){this.expandButton=this.container.getElementsByClassName('btn-expander')[0];this.container.addEventListener('click',this.handleClick.bind(this));}}},isCookieSet:function(){var me=this;if(document.cookie.split(';').filter(function(item){return item.indexOf(''+me.cookieObj.name+'=1')>=0;}).length){return true;} return false;},buildDom:function(){var container=document.createElement('div'),innerHTML;container.className='size1080--min noPrint privacy-alert';container.setAttribute('id','privacy-alert');innerHTML=['<div class="box box--semi-transparent">','   <div class="size-sm-1of1 size-md-960 size-md-1080 privacy-alert__basic">','       <p class="mbn">Cboe believes it is important for you to know how we use cookies and process any other personal data you may disclose to Cboe.</p>','       <div class="privacy-alert__button-group">','           <button class="btn-expander"><i class="btn-expander__icon btn-expander__icon--open"></i>Read less</button>','           <button class="btn btn--submit">I agree</button>','       </div>','   </div>','</div>','<div class="box box--white" id="privacy-alert-toggle">','   <div class="size-sm-1of1 size-md-960 size-md-1080 privacy-alert__extra">','       <p>Please carefully review <a href="/privacy">Cboe\'s Privacy Notice and Policy</a> for more information on Cboe\'s use of cookies and personal data.  Please also review the <a href="/terms">Terms and Conditions for Use of Cboe Websites</a>, which contain important risk disclosures and limitations on liability.  By continuing to use Cboe websites, or by clicking "I agree", you consent to the use of cookies and accept <a href="/privacy">Cboe\'s Privacy Notice and Policy</a> and <a href="/terms">Terms and Conditions for Use of Cboe Websites</a>.</p>','   </div>','</div>'];container.innerHTML=innerHTML.join('');document.body.appendChild(container);},handleClick:function(event){if(event.target&&this.selectorMatches(event.target,'button.btn-expander')||event.target.nodeName==='I'){this.changeButtonIcon();this.toggleExtraText();} if(event.target.classList.contains('btn--submit')){this.destroy();this.setCookie();}},selectorMatches:function(element,selector){if(element.msMatchesSelector){return element.msMatchesSelector(selector);} return element.matches(selector);},setCookie:function(){var expires='; expires='+this.expire.toGMTString(),domain=this.getCookieDomainName();document.cookie=this.cookieObj.name+'='+this.cookieObj.value+expires+';path=/'+domain;},getCookieDomainName:function(){var domain=window.location.hostname;if(new RegExp('cboe.com').test(window.location.hostname)){domain='cboe.com';} return';domain='+domain;},changeButtonIcon:function(){var icon=this.expandButton.childNodes[0],buttonText=this.expandButton.childNodes[1];icon.classList.toggle('btn-expander__icon--open');if(icon.classList.contains('btn-expander__icon--open')){buttonText.nodeValue='Read less';}else{buttonText.nodeValue='Read more';}},toggleExtraText:function(){document.getElementById('privacy-alert-toggle').classList.toggle('js-hide');},destroy:function(){document.body.removeChild(this.container);}};
 (function(){var sidebarheader=Ext.get('sidebar-close-button'),sidebarOpenButton=Ext.get('sidebar-open-button'),sidebarCloseButton=Ext.get('sidebar-close-button'),sidebar=Ext.get('side-bar'),pathName=location.pathname,isFullWidth=bats.fullWidth;if(sidebar){setListeners();setTheBar();adjustMenuPosition();window.onresize=Ext.Function.createThrottled(setTheBar,1000);window.onscroll=Ext.Function.createThrottled(adjustMenuPosition,10);openInNotices();} function adjustMenuPosition(){var sidebarOpenButton=Ext.get('sidebar-open-button'),sidebar=Ext.get('side-bar'),headerHeight=Ext.get('site--header').getHeight(),triggerHeight=headerHeight+124;if(sidebarOpenButton.getTop()<triggerHeight+9){sidebar.setTop(headerHeight-8);}else{sidebar.setTop(0);}} function toggleSideBar(){if(sidebarOpenButton.getLeft()===0){openSideBar();}else{closeSideBar();}} function openSideBar(){sidebar.setLeft(0);sidebarOpenButton.setLeft(-60);} function closeSideBar(){sidebar.setLeft((sidebar.getWidth()+60)*-1);sidebarOpenButton.setLeft(0);} function setDisplay(visibility,who){var element=Ext.get(who);if(element){element.dom.style.display=visibility;}} function setTheBar(){var browserWidth=document.body.clientWidth,sidebar=Ext.get('side-bar');if(browserWidth<=780){setDisplay('none','side-bar');setDisplay('none','sidebar-open-button');}else{setDisplay('block','side-bar');setDisplay('block','sidebar-open-button');} if(availableSidebarWidth()<sidebar.getWidth()){closeSideBar();sidebar.setLeft(-900);setListeners();}else if(isFullWidth){closeSideBar();}else{openSideBar();}} function availableSidebarWidth(){var mainEls=document.getElementsByTagName('main');var browserWidth=document.body.clientWidth;var mainContentWidth;if(mainEls&&mainEls.length>0){mainContentWidth=document.getElementsByTagName('main')[0].clientWidth;}else{mainContentWidth=700;} return(browserWidth-mainContentWidth)/2;} function fixedMenu(){sidebarCloseButton.addCls('js-no-bg');sidebarCloseButton.dom.removeEventListener('click',toggleSideBar);sidebarOpenButton.dom.removeEventListener('click',toggleSideBar);} function setListeners(){sidebarCloseButton.removeCls('js-no-bg');sidebarCloseButton.dom.addEventListener('click',toggleSideBar);sidebarOpenButton.dom.addEventListener('click',toggleSideBar);} function openInNotices(){var myPath=location.pathname;if(myPath.indexOf('notices')!=-1){openSideBar();}}})();